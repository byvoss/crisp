<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRISP Theme Toggle Example</title>
  <link rel="stylesheet" href="../dist/crisp.css">
</head>
<body>
  <!-- Theme Toggle Component -->
  <div class="theme-toggle" role="radiogroup" aria-label="Choose theme">
    <input type="radio" id="theme-light" name="theme" value="light">
    <label for="theme-light" role="radio" aria-label="Light theme">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
        <circle cx="10" cy="10" r="5"/>
        <path d="M10 0v4M10 16v4M0 10h4M16 10h4M3 3l3 3M14 14l3 3M3 17l3-3M14 6l3-3"/>
      </svg>
    </label>
    
    <input type="radio" id="theme-system" name="theme" value="system" checked>
    <label for="theme-system" role="radio" aria-label="System theme">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
        <rect x="2" y="4" width="16" height="12" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
        <path d="M6 16v2M14 16v2M6 18h8"/>
      </svg>
    </label>
    
    <input type="radio" id="theme-dark" name="theme" value="dark">
    <label for="theme-dark" role="radio" aria-label="Dark theme">
      <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
        <path d="M10 2a8 8 0 108 8c0-.7-.1-1.4-.3-2a6 6 0 01-7.7-7.7c-.6-.2-1.3-.3-2-.3z"/>
      </svg>
    </label>
  </div>

  <!-- JavaScript for theme switching -->
  <script>
    class ThemeManager {
      constructor() {
        this.root = document.documentElement;
        this.toggles = document.querySelectorAll('input[name="theme"]');
        this.mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        
        this.init();
      }
      
      init() {
        // Load saved preference
        const saved = localStorage.getItem('theme') || 'system';
        const input = document.querySelector(`input[value="${saved}"]`);
        if (input) input.checked = true;
        
        // Apply initial theme
        this.applyTheme(saved);
        
        // Listen for changes
        this.toggles.forEach(toggle => {
          toggle.addEventListener('change', (e) => {
            this.setTheme(e.target.value);
          });
        });
        
        // Listen for system changes
        this.mediaQuery.addEventListener('change', () => {
          const current = document.querySelector('input[name="theme"]:checked');
          if (current?.value === 'system') {
            this.applyTheme('system');
          }
        });
      }
      
      setTheme(theme) {
        // Add transition class
        this.root.classList.add('theme-transitioning');
        
        // Save preference
        localStorage.setItem('theme', theme);
        
        // Apply theme
        this.applyTheme(theme);
        
        // Remove transition class after animation
        setTimeout(() => {
          this.root.classList.remove('theme-transitioning');
        }, 50);
      }
      
      applyTheme(theme) {
        // Remove existing theme
        this.root.removeAttribute('data-theme');
        
        // Apply new theme
        if (theme === 'light') {
          this.root.setAttribute('data-theme', 'light');
        } else if (theme === 'dark') {
          this.root.setAttribute('data-theme', 'dark');
        }
        // 'system' uses media query (no attribute)
      }
    }
    
    // Initialize on DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      new ThemeManager();
    });
  </script>

  <!-- Demo content -->
  <main class="as-container as-stack" style="--stack-gap: var(--space-2-0); padding-block: var(--space-4-0);">
    <h1 class="text" style="--text-size: 2.5rem;">CRISP Theme System</h1>
    
    <article class="card as-stack with-shadow with-padding">
      <h2 class="text" style="--text-size: 1.5rem;">Automatic Theme Support</h2>
      <p>CRISP includes a complete light/dark theme system that:</p>
      <ul>
        <li>Respects system preferences</li>
        <li>Allows manual override</li>
        <li>Provides smooth transitions</li>
        <li>Maintains WCAG contrast ratios</li>
      </ul>
      <button class="button with-interaction">
        Primary Button
      </button>
    </article>
    
    <section class="as-grid" style="--grid-columns: 2;">
      <div class="card with-border with-padding">
        <h3>Surface Colors</h3>
        <p class="text" style="--text-color: var(--color-text-secondary);">
          Secondary text color
        </p>
      </div>
      
      <div class="card with-elevation-md with-padding" style="background: var(--color-surface-variant);">
        <h3>Elevated Surface</h3>
        <p>Different elevation levels</p>
      </div>
    </section>
    
    <form class="form as-stack with-border with-padding">
      <div class="field as-stack">
        <label for="demo-input">Input Field</label>
        <input id="demo-input" class="input with-border" type="text" placeholder="Type here...">
      </div>
      
      <div class="as-cluster">
        <span class="badge" style="--badge-bg: var(--color-error); --badge-color: var(--color-on-error);">Error</span>
        <span class="badge" style="--badge-bg: var(--color-success); --badge-color: var(--color-on-success);">Success</span>
        <span class="badge" style="--badge-bg: var(--color-primary-container); --badge-color: var(--color-on-primary-container);">Info</span>
      </div>
    </form>
  </main>
</body>
</html>